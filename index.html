<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estacionamento</title>
    <link rel="stylesheet" href="./css/style.css">
    <link rel="shortcut icon" type="imagex/ico" href="/assets/logo-ico.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .hidden {
            display: none;
        }

        .nav-link.active {
            color: #007bff;
        }
    </style>
</head>

<body>
    <nav>
        <div class="logo-name">
            <div class="logo-image">
                <img id="logo" src="/assets/logo-black-white.png" alt="logo-top" width="50px" />
                <span>AutoSavvy<br>Park</span>
            </div>
        </div>
        <div class="menu-items">
            <ul class="nav-links">
                <li>
                    <a href="#" class="nav-link active" data-target="home-section">
                        <i class="fa-solid fa-house"></i>
                        <span class="link-name">Inicio</span>
                    </a>
                </li>
                <br>
                <li>
                    <a href="#" class="nav-link" data-target="pagamento-section">
                        <i class="fa-solid fa-money-bill"></i>
                        <span class="link-name">Pagamento</span>
                    </a>
                </li>
                <br>
                <li>
                    <a href="#" class="nav-link" data-target="vagas-section">
                        <i class="fa-solid fa-car"></i>
                        <span class="link-name">Vagas</span>
                    </a>
                </li>
                <br>
                <li>
                    <a href="#" class="nav-link" data-target="clientes-section">
                        <i class="fa-solid fa-list-ul"></i>
                        <span class="link-name">Lista de Clientes</span>
                    </a>
                </li>
                <br>
                <li>
                    <a href="#" class="nav-link" data-target="custo-section">
                        <i class="fa-solid fa-file-invoice-dollar"></i>
                        <span class="link-name">Custo Minuto</span>
                    </a>
                </li>
                <br>
                <li>
                    <a href="#" class="nav-link" data-target="caixa-section">
                        <i class="fa-solid fa-money-bill-transfer"></i>
                        <span class="link-name">Caixa</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
    <section id="home-section" class="home">
        <h1>PREENCHER DADOS</h1>
        <input class="add-vaga" type="text" name="placa" id="placa" placeholder="Placa" maxlength="8" required>
        <input class="add-vaga" type="text" name="modelo" id="modelo" placeholder="Modelo" minlength="3" required>
        <input class="add-vaga" type="text" name="nome" id="nome" placeholder="Nome" minlength="3" required>
        <input class="add-vaga" type="text" name="contato" id="contato" placeholder="Contato" maxlength="15" required>
        <button class="add" id="btn">Adicionar Veiculo <i class="fa-solid fa-plus"></i></button>
        <div id="popup-message"></div>
    </section>
    <section id="pagamento-section" class="pagamento hidden">
        <div style="display: flex; justify-content: center;">
            <input type="text" id="search-input" placeholder="Digite a placa do veículo">
        </div>
        
        <div id="search-results"></div>
        <div class="content-pagamentos">
            <div class="info-pay" id="info-pay">
            </div>
        </div>
        <div id="popup" class="popup">
            <div class="popup-content">
                <span class="close" id="close">&times;</span>
                <div class="pcontent">
                    <h2>Detalhes do Pagamento</h2>
                    <div id="popup-ticket"></div>
                </div>
            </div>
        </div>
    </section>
    <section id="vagas-section" class="vagas hidden">
        <h1 style="text-align: center; font-size: 24px;">ÁREA A</h1>
        <div class="container-vaga">
            <div class="vaga-a">
                <button class="vaga" data-vaga="A1">
                    <span>A1</span>
                </button>
                <button class="vaga" data-vaga="A2">
                    <span>A2</span>
                </button>
                <button class="vaga" data-vaga="A3">
                    <span>A3</span>
                </button>
                <button class="vaga" data-vaga="A4">
                    <span>A4</span>
                </button>
                <button class="vaga" data-vaga="A5">
                    <span>A5</span>
                </button>
                <button class="vaga" data-vaga="A6">
                    <span>A6</span>
                </button>
            </div>
            <div class="vaga-b">
                <button class="vaga" data-vaga="A7">
                    <span>A7</span>
                </button>
                <button class="vaga" data-vaga="A8">
                    <span>A8</span>
                </button>
                <button class="vaga" data-vaga="A9">
                    <span>A9</span>
                </button>
                <button class="vaga" data-vaga="A10">
                    <span>A10</span>
                </button>
                <button class="vaga" data-vaga="A11">
                    <span>A11</span>
                </button>
                <button class="vaga" data-vaga="A12">
                    <span>A12</span>
                </button>
            </div>
            <section class="categorias">
                <button class="areas">
                    <p>Área A</p>
                </button>
                <button class="areas">
                    <p>Área B</p>
                </button>
                <button class="areas">
                    <p>Área C</p>
                </button>
            </section>
        </div>
    </section>
    <section id="clientes-section" class="clientes hidden">
        <div class="clientes-content">
            <h1>HISTORICO</h1>
            <label for="filterDate">Filtrar por data:</label>
            <input type="date" id="filterDate">
            <table id="tabelaClientes">
                <thead>
                    <tr>
                        <th>DATA</th>
                        <th>HORÁRIO</th>
                        <th>PLACA</th>
                        <th>MODELO</th>
                        <th>CONTATO</th>
                        <th>NOME</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </section>
    <section id="custo-section" class="custo hidden">
        <h1 style="text-align: center;">PREÇO POR MINUTO</h1>
        <div>
            <input class="add-vaga" id="addvalor" type="number" format="currency" placeholder="Custo Por Minuto"
                maxlength="10" />
            <button class="add" id="atualizar">
                Atualizar Valor <i class="fa-solid fa-dollar-sign"></i>
            </button>
        </div>
    </section>
    <section id="caixa-section" class="caixa hidden">
        <div class="clientes-content">
            <h1>CAIXA</h1>
            <label for="filterDate">Filtrar por data:</label>
            <input type="date" id="filterData">
            <table id="tabelaCaixa">
                <thead>
                    <tr>
                        <th>DATA</th>
                        <th>TEMPO ESTACIONADO</th>
                        <th>PLACA</th>
                        <th>MODELO</th>
                        <th>VALOR</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <h4 style="margin-top: 40px;">RECEITA DO DIA: R$</h4>
        </div>
    </section>
    <script>
        async function createPayment() {
            try {
                const response = await fetch('http://localhost:3000/payments', { method: 'POST' });
                const data = await response.json();
                console.log(data);

                // Verifica se a resposta contém o ticket_url
                if (data && data.point_of_interaction && data.point_of_interaction.transaction_data && data.point_of_interaction.transaction_data.ticket_url) {
                    // Redireciona para o URL do ticket
                    window.location.href = data.point_of_interaction.transaction_data.ticket_url;
                } else {
                    alert('Não foi possível obter o URL do ticket.');
                }
            } catch (error) {
                console.error(error);
                alert('Erro ao criar pagamento.');
            }
        }
    </script>
    <script src="js/formater.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/9.6.8/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/9.6.8/firebase-database.js"></script>
    <script type="module" src="/js/firebase.js"></script>
    <script type="module" src="/js/submit.js"></script>
    <script type="module" src="/js/clientes.js"></script>
    <script type="module" src="/js/custo.js"></script>
    <script type="module" src="/js/vagas.js"></script>
    <script type="module" src="/js/caixa.js"></script>
    <script type="module" src="/js/ticket.js"></script>
    <script type="module" src="/js/filtrocliente.js"></script>
    <script defer src="/js/sections.js"></script>
</body>

</html>